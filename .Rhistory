setwd("C:/Users/Joaquin/Desktop/UdeSA/Maestría en Economía/Herramientas Computacionales Para Investigación/Herramientas-Computacionales-Liwski-Sury-Trabajo-Final")
#Cargo Paquetes
suppressMessages({
if(!require("pacman")) install.packages("pacman")
pacman::p_load("tidyverse","readxl","haven","sf","rgdal")
})
rm(list=ls())
#cargo los dta
inputfolder<-"Data, figuras y do originales/Data-Original/"
dtas<-list.files(path= inputfolder, recursive = TRUE, include.dirs = TRUE)
for(file in dtas) {
# nombre al cual le asigno cada dta
obj_name <- gsub(".dta", "", file)
#open file
dta_file <- read_dta(paste0(inputfolder,file))
# Assign
assign(obj_name, dta_file)
}
#Borro lo que este de mas
rm(dta_file,dtas,file,obj_name)
#Inporto SHP
#municipioshp <- read_sf("Data, figuras y do originales/municipios_mx_feb2018/municipios_mx_feb2018.shp") #faster
municipioshp <- readOGR("Data, figuras y do originales/municipios_mx_feb2018/municipios_mx_feb2018.shp")
View(caract_muni)
plot(municipioshp)
municipioshp@data$NOMGEO
View(merge_ss_eneu_final)
which(merge_ss_eneu_final=="")
View(merge_ss_eneu_final)
#Limpio nombres de merge
merge_ss_eneu_final[which(merge_ss_eneu_final$descripcion_municipio=="")]
[which(merge_ss_eneu_final$descripcion_municipio=="")
which(merge_ss_eneu_final$descripcion_municipio=="")
#Limpio nombres de merge
merge_ss_eneu_final[which(merge_ss_eneu_final$descripcion_municipio=="")]<-merge_ss_eneu_final$name_ss[which(merge_ss_eneu_final$descripcion_municipio=="")]
#Limpio nombres de merge
merge_ss_eneu_final$descripcion_municipio[which(merge_ss_eneu_final$descripcion_municipio=="")]<-merge_ss_eneu_final$name_ss[which(merge_ss_eneu_final$descripcion_municipio=="")]
str_to_title(iconv(merge_ss_eneu_final$descripcion_municipio, to = 'ASCII//TRANSLIT'))
#Inporto SHP
#municipioshp <- read_sf("Data, figuras y do originales/municipios_mx_feb2018/municipios_mx_feb2018.shp") #faster
municipio <- readOGR("Data, figuras y do originales/municipios_mx_feb2018/municipios_mx_feb2018.shp")
#plot(municipioshp)
#Names
municipio@data$NOMGEO
#plot(municipioshp)
#Names
municipio@data$NOMGEO<-str_to_title(iconv(municipio@data$NOMGEO, to = 'ASCII//TRANSLIT'))
#chequeamos si esta todo ok
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
#plot(municipioshp)
#Names
municipio@data$NOMGEO<-str_to_title(iconv(municipio@data$NOMGEO, to = 'ASCII//TRANSLIT'))
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
municipio@data$NOMGEO
merge_ss_eneu_final$descripcion_municipio
#Limpio nombres de merge
merge_ss_eneu_final$descripcion_municipio[which(merge_ss_eneu_final$descripcion_municipio=="")]<-merge_ss_eneu_final$name_ss[which(merge_ss_eneu_final$descripcion_municipio=="")]
merge_ss_eneu_final$descripcion_municipio<-str_to_title(iconv(merge_ss_eneu_final$descripcion_municipio, to = 'ASCII//TRANSLIT'))
merge_ss_eneu_final$descripcion_municipio
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
View(municipio)
view(municipio@data$NOMGEO)
view(merge_ss_eneu_final$descripcion_municipio)
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setwd("C:/Users/Joaquin/Desktop/UdeSA/Maestría en Economía/Herramientas Computacionales Para Investigación/Herramientas-Computacionales-Liwski-Sury-Trabajo-Final")
#Cargo Paquetes
suppressMessages({
if(!require("pacman")) install.packages("pacman")
pacman::p_load("tidyverse","readxl","haven","sf","rgdal")
})
rm(list=ls())
#cargo los dta
inputfolder<-"Data, figuras y do originales/Data-Original/"
dtas<-list.files(path= inputfolder, recursive = TRUE, include.dirs = TRUE)
for(file in dtas) {
# nombre al cual le asigno cada dta
obj_name <- gsub(".dta", "", file)
#open file
dta_file <- read_dta(paste0(inputfolder,file))
# Assign
assign(obj_name, dta_file)
}
#Borro lo que este de mas
rm(dta_file,dtas,file,obj_name)
#Limpio nombres de merge
merge_ss_eneu_final$descripcion_municipio[which(merge_ss_eneu_final$descripcion_municipio=="")]<-merge_ss_eneu_final$name_ss[which(merge_ss_eneu_final$descripcion_municipio=="")]
merge_ss_eneu_final$descripcion_municipio<-str_to_title(iconv(merge_ss_eneu_final$descripcion_municipio, to = 'Latin1'))
#Inporto SHP
#municipioshp <- read_sf("Data, figuras y do originales/municipios_mx_feb2018/municipios_mx_feb2018.shp") #faster
municipio <- readOGR("Data, figuras y do originales/municipios_mx_feb2018/municipios_mx_feb2018.shp")
#plot(municipioshp)
#Names
municipio@data$NOMGEO<-str_to_title(iconv(municipio@data$NOMGEO, to = 'ASCII//TRANSLIT'))
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
rm(list=ls())
#cargo los dta
inputfolder<-"Data, figuras y do originales/Data-Original/"
dtas<-list.files(path= inputfolder, recursive = TRUE, include.dirs = TRUE)
for(file in dtas) {
# nombre al cual le asigno cada dta
obj_name <- gsub(".dta", "", file)
#open file
dta_file <- read_dta(paste0(inputfolder,file))
# Assign
assign(obj_name, dta_file)
}
#Borro lo que este de mas
rm(dta_file,dtas,file,obj_name)
#Limpio nombres de merge
merge_ss_eneu_final$descripcion_municipio[which(merge_ss_eneu_final$descripcion_municipio=="")]<-merge_ss_eneu_final$name_ss[which(merge_ss_eneu_final$descripcion_municipio=="")]
#merge_ss_eneu_final$descripcion_municipio<-str_to_title(iconv(merge_ss_eneu_final$descripcion_municipio, to = 'Latin1'))
merge_ss_eneu_final$descripcion_municipio<-str_to_title(merge_ss_eneu_final$descripcion_municipio)
municipio <- readOGR("Data, figuras y do originales/municipios_mx_feb2018/municipios_mx_feb2018.shp")
#plot(municipioshp)
#Names
municipio@data$NOMGEO<-str_to_title(iconv(municipio@data$NOMGEO, to = 'ASCII//TRANSLIT'))
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
#plot(municipioshp)
#Names
municipio@data$NOMGEO<-str_to_title(iconv(municipio@data$NOMGEO, to = 'Latin1'))
#plot(municipioshp)
#Names
municipio@data$NOMGEO
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
#chequeamos si esta todo ok
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
#chequeamos si esta todo ok
data.frame(
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO),
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio))
#chequeamos si esta todo ok
data.frame(
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO),
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio))
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)
data.frame(
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)[1:333],
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio))
view(data.frame(
setdiff(merge_ss_eneu_final$descripcion_municipio,municipio@data$NOMGEO)[1:333],
setdiff(municipio@data$NOMGEO,merge_ss_eneu_final$descripcion_municipio)))
View(merge_ss_eneu_final)
pacman::p_load("tidyverse","readxl","haven","sf","rgdal","RecordLinkage")
municipio@data
View(merge_ss_eneu_final)
#Paso a numeric la variable en base a la cual voy a unir.
municipio@data$CVEGEO<-as.numeric(municipio@data$CVEGEO)
municipio@data<-municipio@data%>%left_join(merge_ss_eneu_final,by("CVEGEO"="municipality"))
municipio@data
merge_ss_eneu_final
municipio@data
municipio@data<-municipio@data%>%left_join(merge_ss_eneu_final,by("CVEGEO"="municipality"))
municipio@data%>%left_join(merge_ss_eneu_final,by("CVEGEO"="municipality"))
?left_join
municipio@data<-municipio@data%>%left_join(merge_ss_eneu_final,by=c("CVEGEO"="municipality"))
View(affiliated)
View(caract_muni)
View(benef_SP_2002_2009)
View(caract_muni)
View(benef_SP_2002_2009)
